# ============================================
# CHATFLOW PRO - Environment Variables
# ============================================
# IMPORTANTE: NO comitear el archivo .env real
# Este es solo un ejemplo. Copia a .env y completa los valores.

# ============================================
# DATABASE
# ============================================
POSTGRES_PASSWORD=cambiar-por-password-seguro-aqui
DATABASE_URL=postgresql://chatflow_user:${POSTGRES_PASSWORD}@chatflow-postgres:5432/chatflow_prod

# Para desarrollo local (sin Docker):
# DATABASE_URL=postgresql://chatflow_user:password@localhost:5432/chatflow_prod

# ============================================
# JWT AUTHENTICATION
# ============================================
# Generar con: node -e "console.log(require('crypto').randomBytes(32).toString('hex'))"
JWT_SECRET=cambiar-por-secreto-aleatorio-minimo-32-caracteres-aqui
JWT_EXPIRES_IN=1h
JWT_REFRESH_EXPIRES_IN=7d

# ============================================
# APPLICATION URLS
# ============================================
# Frontend URL (para CORS)
FRONTEND_URL=https://chatflow.tudominio.com

# Backend URL (para frontend hacer requests)
BACKEND_URL=https://api.chatflow.tudominio.com

# API URL para frontend (Vite)
VITE_API_URL=https://api.chatflow.tudominio.com/api

# Para desarrollo local:
# FRONTEND_URL=http://localhost:3000
# BACKEND_URL=http://localhost:3001
# VITE_API_URL=http://localhost:3001/api

# ============================================
# META WHATSAPP API (Configuración Global)
# ============================================
# NOTA: Cada organización puede tener su propio Access Token
# Estos son valores por defecto opcionales

# META_ACCESS_TOKEN=tu-access-token-de-meta-aqui
# META_WABA_ID=tu-whatsapp-business-account-id
# META_PHONE_NUMBER_ID=tu-phone-number-id
# META_API_VERSION=v21.0
# META_WEBHOOK_VERIFY_TOKEN=tu-token-de-verificacion-webhook

# ============================================
# n8n INTEGRATION (Automatizaciones)
# ============================================
# URL base de tus webhooks de n8n
N8N_WEBHOOK_URL=https://n8n.tudominio.com/webhook/chatflow

# API Key de n8n (si lo configuraste)
# N8N_API_KEY=tu-n8n-api-key

# ============================================
# FLOWISE INTEGRATION (Chatbot IA)
# ============================================
# URL de tu instancia de Flowise
FLOWISE_API_URL=https://flowise.tudominio.com/api/v1

# API Key de Flowise
FLOWISE_API_KEY=tu-flowise-api-key-aqui

# Flow ID por defecto (puedes tener múltiples)
FLOWISE_DEFAULT_FLOW_ID=tu-flow-id-aqui

# ============================================
# REDIS (Opcional - Cache & Sessions)
# ============================================
REDIS_PASSWORD=cambiar-por-password-seguro-aqui
REDIS_URL=redis://:${REDIS_PASSWORD}@chatflow-redis:6379

# Para desarrollo local:
# REDIS_URL=redis://:password@localhost:6379

# ============================================
# NODE ENVIRONMENT
# ============================================
NODE_ENV=production
PORT=3001

# Para desarrollo:
# NODE_ENV=development
# PORT=3001

# ============================================
# CORS
# ============================================
CORS_ORIGIN=https://chatflow.tudominio.com

# Para desarrollo (permitir múltiples orígenes):
# CORS_ORIGIN=http://localhost:3000,http://localhost:3001

# ============================================
# EMAIL SERVICE (Opcional - para notificaciones)
# ============================================
# SMTP_HOST=smtp.gmail.com
# SMTP_PORT=587
# SMTP_SECURE=false
# SMTP_USER=tu-email@gmail.com
# SMTP_PASSWORD=tu-app-password
# SMTP_FROM=ChatFlow Pro <noreply@chatflow.com>

# ============================================
# SENDGRID (Alternativa a SMTP)
# ============================================
# SENDGRID_API_KEY=tu-sendgrid-api-key
# SENDGRID_FROM=noreply@chatflow.com

# ============================================
# STORAGE (Opcional - para archivos)
# ============================================
# AWS S3
# AWS_ACCESS_KEY_ID=tu-access-key
# AWS_SECRET_ACCESS_KEY=tu-secret-key
# AWS_REGION=us-east-1
# AWS_S3_BUCKET=chatflow-uploads

# Cloudflare R2 (compatible con S3)
# R2_ACCOUNT_ID=tu-account-id
# R2_ACCESS_KEY_ID=tu-access-key
# R2_SECRET_ACCESS_KEY=tu-secret-key
# R2_BUCKET_NAME=chatflow-uploads

# ============================================
# MONITORING (Opcional)
# ============================================
# Sentry para error tracking
# SENTRY_DSN=https://xxx@sentry.io/xxx

# Plausible o Google Analytics
# ANALYTICS_ID=tu-analytics-id

# ============================================
# RATE LIMITING
# ============================================
THROTTLE_TTL=60
THROTTLE_LIMIT=100

# ============================================
# STRIPE (Opcional - para pagos)
# ============================================
# STRIPE_SECRET_KEY=sk_test_xxx
# STRIPE_PUBLISHABLE_KEY=pk_test_xxx
# STRIPE_WEBHOOK_SECRET=whsec_xxx

# ============================================
# FEATURE FLAGS (Opcional)
# ============================================
# ENABLE_SIGNUP=true
# ENABLE_AI_CHATBOT=true
# ENABLE_N8N_INTEGRATION=true
# ENABLE_METABASE_EMBED=true

# ============================================
# LIMITES POR DEFECTO (para nuevas organizaciones)
# ============================================
DEFAULT_MAX_CONTACTS=1000
DEFAULT_MAX_MESSAGES_PER_MONTH=1000
DEFAULT_TRIAL_DAYS=14

# ============================================
# LOGGING
# ============================================
LOG_LEVEL=info
# Opciones: error, warn, info, debug

# ============================================
# TIMEZONE
# ============================================
TZ=America/Mexico_City
# O la timezone de tu región

# ============================================
# METABASE (Opcional - para embeds)
# ============================================
# METABASE_SITE_URL=https://metabase.tudominio.com
# METABASE_SECRET_KEY=tu-metabase-secret-key

# ============================================
# DESARROLLO - SEEDS
# ============================================
# Crear datos de ejemplo al iniciar (solo dev)
# CREATE_DEMO_DATA=true
# DEMO_ADMIN_EMAIL=admin@demo.com
# DEMO_ADMIN_PASSWORD=admin123

# ============================================
# PROXY (Opcional - si usas proxy)
# ============================================
# HTTP_PROXY=http://proxy.tuempresa.com:8080
# HTTPS_PROXY=http://proxy.tuempresa.com:8080
# NO_PROXY=localhost,127.0.0.1

# ============================================
# BACKUPS (Opcional)
# ============================================
# BACKUP_ENABLED=true
# BACKUP_SCHEDULE=0 2 * * * # Diario a las 2am
# BACKUP_RETENTION_DAYS=7
# BACKUP_S3_BUCKET=chatflow-backups

# ============================================
# HEALTH CHECK
# ============================================
HEALTH_CHECK_PATH=/health
HEALTH_CHECK_ENABLED=true

# ============================================
# SEGURIDAD
# ============================================
# Habilitar helmet para headers de seguridad
ENABLE_HELMET=true

# Habilitar rate limiting
ENABLE_RATE_LIMIT=true

# Habilitar CSRF protection
# ENABLE_CSRF=true

# ============================================
# WEBHOOKS SALIENTES (Opcional)
# ============================================
# Notificar a URL externa cuando ocurren eventos
# WEBHOOK_ON_NEW_MESSAGE=https://tu-sistema.com/webhook/message
# WEBHOOK_ON_NEW_CONTACT=https://tu-sistema.com/webhook/contact
# WEBHOOK_SECRET=tu-webhook-secret

# ============================================
# INTEGRACIONES ADICIONALES (Futuro)
# ============================================
# Zapier
# ZAPIER_WEBHOOK_URL=https://hooks.zapier.com/xxx

# Make (formerly Integromat)
# MAKE_WEBHOOK_URL=https://hook.make.com/xxx

# Slack
# SLACK_WEBHOOK_URL=https://hooks.slack.com/services/xxx
# SLACK_BOT_TOKEN=xoxb-xxx

# Discord
# DISCORD_WEBHOOK_URL=https://discord.com/api/webhooks/xxx

# ============================================
# NOTAS DE SEGURIDAD
# ============================================
# 1. NUNCA comitear este archivo con valores reales
# 2. Usar secrets manager en producción (Coolify Secrets, AWS Secrets Manager, etc.)
# 3. Rotar passwords y tokens regularmente
# 4. Usar diferentes valores para dev/staging/production
# 5. Validar que JWT_SECRET tenga mínimo 32 caracteres
# 6. Usar HTTPS en producción (obligatorio)
# 7. Habilitar rate limiting para prevenir ataques
# 8. Configurar CORS correctamente (no usar * en producción)

# ============================================
# COMANDOS ÚTILES
# ============================================
# Generar JWT_SECRET aleatorio:
# node -e "console.log(require('crypto').randomBytes(32).toString('hex'))"

# Generar password seguro:
# openssl rand -base64 32

# Test de conexión a database:
# psql $DATABASE_URL -c "SELECT 1;"

# Verificar variables en Coolify:
# docker exec chatflow-backend env | grep -i jwt
